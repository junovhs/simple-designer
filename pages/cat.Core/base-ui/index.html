<!DOCTYPE html>
<html>
<head>
    <style>
        /* Base UI Styles: Full Affinity Polish (Shadows, Gradients, Spacing) */
        :root { --shadow-sm: 0 1px 3px rgba(0,0,0,0.1); --shadow-md: 0 4px 6px rgba(0,0,0,0.1); --gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        [data-theme="dark"] { --shadow-sm: 0 1px 3px rgba(0,0,0,0.5); --shadow-md: 0 4px 6px rgba(0,0,0,0.5); --gradient: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%); }
        .base-tool { display: block; margin: 0.5rem 0; padding: 0.75rem; border: 1px solid var(--border); border-radius: 6px; background: var(--gradient); cursor: pointer; text-align: center; transition: all 0.2s; box-shadow: var(--shadow-sm); }
        .base-tool:hover { background: var(--accent); color: white; box-shadow: var(--shadow-md); transform: translateY(-1px); }
        .base-icon { width: 24px; height: 24px; display: block; margin: 0 auto 0.25rem; fill: currentColor; }
        .base-group { margin: 1.5rem 0; padding: 1rem; border: 1px solid var(--border); border-radius: 8px; background: var(--panel); box-shadow: var(--shadow-sm); }
        .base-group h4 { margin: 0 0 0.75rem 0; font-size: 0.95rem; font-weight: 600; color: var(--accent); }
        .base-slider { width: 100%; margin: 0.5rem 0; height: 4px; background: var(--border); border-radius: 2px; }
        .base-slider::-webkit-slider-thumb { appearance: none; width: 16px; height: 16px; background: var(--accent); border-radius: 50%; cursor: pointer; }
        .base-input { width: 100%; padding: 0.5rem; border: 1px solid var(--border); border-radius: 4px; margin: 0.25rem 0; background: white; transition: border 0.2s; }
        .base-input:focus { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(0,123,255,0.25); outline: none; }
        .base-layer { display: flex; align-items: center; padding: 0.5rem; border-bottom: 1px solid var(--border); cursor: move; transition: background 0.2s; position: relative; }
        .base-layer:hover { background: rgba(0,123,255,0.1); }
        .base-layer.dragging { opacity: 0.5; background: var(--accent); color: white; }
        .base-eye { margin-right: 0.75rem; cursor: pointer; font-size: 1.2rem; transition: color 0.2s; }
        .base-eye:hover { color: var(--accent); }
        .base-tab { padding: 0.75rem 1.5rem; background: none; border: 1px solid var(--border); cursor: pointer; margin-right: 0.25rem; border-radius: 6px 6px 0 0; transition: all 0.2s; }
        .base-tab.active { background: var(--accent); color: white; border-bottom-color: var(--panel); }
        .base-tab:hover:not(.active) { background: var(--gradient); }
        .base-badge { background: linear-gradient(135deg, gold, orange); color: black; padding: 0.5rem 0.75rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; box-shadow: var(--shadow-sm); }
        .base-panel { max-height: 400px; overflow-y: auto; padding-right: 0.5rem; }
        .base-panel::-webkit-scrollbar { width: 6px; }
        .base-panel::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
        /* Drag reorder anim */
        .base-layer { transition: all 0.3s ease; }
        .base-layer.placeholder { min-height: 40px; background: rgba(0,123,255,0.1); border: 2px dashed var(--accent); }
        /* Responsive tweaks */
        @media (max-width: 1200px) { .base-group { padding: 0.75rem; } }
        @media (max-width: 768px) { .base-tool { padding: 0.5rem; font-size: 0.9rem; } }
    </style>
</head>
<body>
    <!-- module: {"id": "base-ui", "slots": ["#tools-left", "#toolbar-top", "#props-right", "#dock-bottom"], "hooks": ["init"]} -->
    <!-- Tools Left: Detailed Groups with Icons -->
    <div id="base-tools-left">
        <div class="base-group">
            <h4>Selection Tools</h4>
            <button class="base-tool" title="Move Tool (V)"><svg class="base-icon" viewBox="0 0 24 24"><path d="M12 2C13.1 2 14 2.9 14 4S13.1 6 12 6 10 5.1 10 4 10.9 2 12 2M12 8C13.1 8 14 8.9 14 10S13.1 12 12 12 10 11.1 10 10 10.9 8 12 8M12 14C13.1 14 14 14.9 14 16S13.1 18 12 18 10 17.1 10 16 10.9 14 12 14M12 20C13.1 20 14 20.9 14 22S13.1 24 12 24 10 23.1 10 22 10.9 20 12 20Z"/></svg>Move</button>
        </div>
        <div class="base-group">
            <h4>Drawing Tools</h4>
            <button class="base-tool" title="Pen Tool (P)"><svg class="base-icon" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l3.06-3.06 4.24 4.24-3.06 3.06L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>Pen</button>
            <button class="base-tool" title="Rectangle Tool"><svg class="base-icon" viewBox="0 0 24 24"><path d="M3 3h18v18H3z"/></svg>Rect</button>
            <button class="base-tool" title="Ellipse Tool"><svg class="base-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>Ellipse</button>
            <button class="base-tool" title="Text Tool (T)"><svg class="base-icon" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>Text</button>
        </div>
        <div class="base-group">
            <h4>Effects Tools</h4>
            <button class="base-tool" title="Gradient Tool"><svg class="base-icon" viewBox="0 0 24 24"><defs><linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#ff0000;stop-opacity:1" /><stop offset="100%" style="stop-color:#0000ff;stop-opacity:1" /></linearGradient></defs><rect width="24" height="24" fill="url(#grad1)"/></svg>Gradient</button>
            <button class="base-tool" title="Transparency Tool"><svg class="base-icon" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l3.06-3.06 4.24 4.24-3.06 3.06L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" opacity="0.5"/></svg>Trans</button>
            <button class="base-tool" title="Drop Shadow"><svg class="base-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" opacity="0.3"/><circle cx="14" cy="14" r="10"/></svg>Shadow</button>
        </div>
        <div class="base-group">
            <h4>Alignment (A)</h4>
            <button class="base-tool" title="Align Left"><svg class="base-icon" viewBox="0 0 24 24"><path d="M3 21h18V3H3v18zM5 5v14h14V5H5z"/></svg></button>
            <button class="base-tool" title="Align Center H"><svg class="base-icon" viewBox="0 0 24 24"><path d="M3 21h18V3H3v18zm6-12h6v6H9V9z"/></svg></button>
            <button class="base-tool" title="Align Right"><svg class="base-icon" viewBox="0 0 24 24"><path d="M21 3H3v18h18V3zm-6 16H5V5h10v14z"/></svg></button>
            <button class="base-tool" title="Align Top"><svg class="base-icon" viewBox="0 0 24 24"><path d="M3 21h18V3H3v18zM5 19V5h14v14H5z"/></svg></button>
            <button class="base-tool" title="Align Center V"><svg class="base-icon" viewBox="0 0 24 24"><path d="M3 21h18V3H3v18zm6-12h6v6H9V9z"/></svg></button>
            <button class="base-tool" title="Align Bottom"><svg class="base-icon" viewBox="0 0 24 24"><path d="M21 3H3v18h18V3zm-6 16H5V5h10v14z"/></svg></button>
        </div>
    </div>

    <!-- Toolbar Top: Detailed Buttons with Icons -->
    <div id="base-toolbar-top" style="flex: 1; display: flex; justify-content: space-between; align-items: center; gap: 1rem;">
        <div style="display: flex; gap: 0.5rem;">
            <button class="base-tool" title="Artboard Tool"><svg class="base-icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/></svg>Artboard</button>
            <button class="base-tool" title="Undo (Ctrl+Z)"><svg class="base-icon" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm3 14H9v-2h6v2zm0-4H9V8h6v4z"/></svg></button>
            <button class="base-tool" title="Redo (Ctrl+Y)"><svg class="base-icon" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm-3 14h6v-2H9v2zm0-4h6V8H9v4z"/></svg></button>
            <button class="base-tool" title="Export"><svg class="base-icon" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>Export</button>
        </div>
        <div class="base-badge" title="Base UI Active - Click to Toggle Fullscreen">Base Cockpit Active</div>
        <button class="base-tool" onclick="document.documentElement.requestFullscreen ? document.documentElement.requestFullscreen() : alert('Fullscreen not supported')" title="Fullscreen"><svg class="base-icon" viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg></button>
    </div>

    <!-- Props Right: Detailed Panels with Sliders/Inputs -->
    <div id="base-props-right" class="base-panel">
        <div class="base-group">
            <h4>Transform Panel</h4>
            <label>X Pos: <input class="base-input" type="number" value="10" step="0.1" placeholder="x"></label>
            <label>Y Pos: <input class="base-input" type="number" value="10" step="0.1" placeholder="y"></label>
            <label>Width: <input class="base-input" type="number" value="100" step="1" placeholder="w"></label>
            <label>Height: <input class="base-input" type="number" value="100" step="1" placeholder="h"></label>
            <label>Rotate: <input class="base-input" type="number" value="0" step="1" placeholder="°"></label>
            <label>Skew: <input class="base-input" type="number" value="0" step="1" placeholder="°"></label>
            <div style="display: flex; gap: 0.25rem; margin-top: 0.5rem; justify-content: center;">
                <button class="base-tool" style="padding: 0.25rem; font-size: 0.8rem;">↖</button>
                <button class="base-tool" style="padding: 0.25rem; font-size: 0.8rem;">↑</button>
                <button class="base-tool" style="padding: 0.25rem; font-size: 0.8rem;">↗</button>
                <button class="base-tool" style="padding: 0.25rem; font-size: 0.8rem;" title="Center">●</button>
                <button class="base-tool" style="padding: 0.25rem; font-size: 0.8rem;">↙</button>
                <button class="base-tool" style="padding: 0.25rem; font-size: 0.8rem;">↓</button>
                <button class="base-tool" style="padding: 0.25rem; font-size: 0.8rem;">↘</button>
            </div>
        </div>
        <div class="base-group">
            <h4>Color Panel (HSL)</h4>
            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <div style="width: 40px; height: 40px; background: hsl(0,100%,50%); border: 1px solid var(--border); border-radius: 50%;"></div>
                <input class="base-input" type="color" value="#ff0000" style="width: auto;">
            </div>
            <label>Hue: <input class="base-slider" type="range" min="0" max="360" value="0" oninput="this.nextElementSibling.textContent = this.value + '°'"><span>0°</span></label>
            <label>Sat: <input class="base-slider" type="range" min="0" max="100" value="100" oninput="this.nextElementSibling.textContent = this.value + '%'"><span>100%</span></label>
            <label>Light: <input class="base-slider" type="range" min="0" max="100" value="50" oninput="this.nextElementSibling.textContent = this.value + '%'"><span>50%</span></label>
            <label>Opacity: <input class="base-slider" type="range" min="0" max="100" value="100" oninput="this.nextElementSibling.textContent = this.value + '%'"><span>100%</span></label>
            <div style="margin-top: 0.5rem; display: flex; gap: 0.25rem;">
                <button class="base-tool" style="flex: 1; padding: 0.5rem;">Fill</button>
                <button class="base-tool" style="flex: 1; padding: 0.5rem;">Stroke</button>
            </div>
        </div>
        <div class="base-group">
            <h4>Typography Panel</h4>
            <label>Font Family:
                <select class="base-input">
                    <option>System UI</option>
                    <option>Arial</option>
                    <option>Helvetica</option>
                    <option>Times New Roman</option>
                    <option>Courier</option>
                </select>
            </label>
            <label>Size: <input class="base-input" type="number" value="16" step="1" placeholder="px"></label>
            <label>Tracking: <input class="base-slider" type="range" min="-100" max="100" value="0" oninput="this.nextElementSibling.textContent = this.value"><span>0</span></label>
            <label>Leading: <input class="base-slider" type="range" min="-100" max="100" value="0" oninput="this.nextElementSibling.textContent = this.value"><span>0</span></label>
            <label>Kerning: <input class="base-slider" type="range" min="-50" max="50" value="0" oninput="this.nextElementSibling.textContent = this.value"><span>0</span></label>
            <div style="margin-top: 0.5rem; display: flex; gap: 0.25rem;">
                <button class="base-tool" style="flex: 1; padding: 0.5rem;">Bold</button>
                <button class="base-tool" style="flex: 1; padding: 0.5rem;">Italic</button>
                <button class="base-tool" style="flex: 1; padding: 0.5rem;">Underline</button>
            </div>
        </div>
        <div class="base-group">
            <h4>Effects Panel</h4>
            <label>Drop Shadow:
                <input class="base-slider" type="range" min="0" max="20" value="5" oninput="this.nextElementSibling.textContent = this.value + 'px'"><span>5px</span>
            </label>
            <label>Blur Radius: <input class="base-slider" type="range" min="0" max="20" value="3" oninput="this.nextElementSibling.textContent = this.value + 'px'"><span>3px</span></label>
            <label>Opacity: <input class="base-slider" type="range" min="0" max="100" value="75" oninput="this.nextElementSibling.textContent = this.value + '%'"><span>75%</span></label>
            <input class="base-input" type="color" value="#000000" style="margin-top: 0.5rem;">
            <div style="margin-top: 0.5rem; display: flex; gap: 0.25rem;">
                <button class="base-tool" style="flex: 1; padding: 0.5rem;">Apply</button>
                <button class="base-tool" style="flex: 1; padding: 0.5rem;">Clear</button>
            </div>
        </div>
    </div>

    <!-- Dock Bottom: Detailed Layers/Effects with Tabs & Drag -->
    <div id="base-dock-bottom" style="flex: 1; display: flex; align-items: center; gap: 1rem; min-height: 60px;">
        <div style="flex: 1; display: flex; border-bottom: 1px solid var(--border);">
            <button class="base-tab active" onclick="switchTab('layers')" id="tab-layers">Layers</button>
            <button class="base-tab" onclick="switchTab('effects')" id="tab-effects">Effects</button>
            <button class="base-tab" onclick="switchTab('masks')" id="tab-masks">Masks</button>
        </div>
        <div style="flex: 3; border: 1px solid var(--border); border-radius: 0 0 6px 6px; padding: 0.5rem; max-height: 200px; overflow-y: auto; background: var(--panel);" id="dock-content">
            <!-- Layers Tab (Default) -->
            <h4>Layers Panel (Drag to Reorder)</h4>
            <div class="base-layer" draggable="true" data-id="1">
                <span class="base-eye" onclick="toggleEye(this)" title="Visible">👁</span>
                <span style="flex: 1;">Background Image (Raster)</span>
                <span style="width: 60px; text-align: right; opacity: 0.7;">1</span>
            </div>
            <div class="base-layer" draggable="true" data-id="2">
                <span class="base-eye" onclick="toggleEye(this)" title="Hidden">🙈</span>
                <span style="flex: 1;">Headline Text (Vector)</span>
                <span style="width: 60px; text-align: right; opacity: 0.7;">2</span>
            </div>
            <div class="base-layer" draggable="true" data-id="3">
                <span class="base-eye" onclick="toggleEye(this)" title="Locked">🔒</span>
                <span style="flex: 1;">Shape Group (Nested)</span>
                <span style="width: 60px; text-align: right; opacity: 0.7;">3</span>
            </div>
            <div class="base-layer" draggable="true" data-id="4">
                <span class="base-eye" onclick="toggleEye(this)" title="Visible">👁</span>
                <span style="flex: 1;">Gradient Overlay</span>
                <span style="width: 60px; text-align: right; opacity: 0.7;">4</span>
            </div>
            <div class="base-layer" draggable="true" data-id="5">
                <span class="base-eye" onclick="toggleEye(this)" title="Visible">👁</span>
                <span style="flex: 1;">Mask Layer (Alpha)</span>
                <span style="width: 60px; text-align: right; opacity: 0.7;">5</span>
            </div>
        </div>
        <!-- Hidden Tabs Content (JS shows) -->
        <div id="effects-tab" style="display: none;">
            <h4>Effects</h4>
            <div class="base-group">
                <label>Drop Shadow: <input class="base-slider" type="range" min="0" max="20" value="5"></label>
                <label>Gradient Stops: <button class="base-tool">Add Stop</button></label>
            </div>
        </div>
        <div id="masks-tab" style="display: none;">
            <h4>Masks</h4>
            <div class="base-group">
                <button class="base-tool">Add Vector Mask</button>
                <button class="base-tool">Add Raster Mask</button>
                <label>Feather: <input class="base-slider" type="range" min="0" max="50" value="0"></label>
            </div>
        </div>
    </div>
    <script>
        // Base UI Module: Static + Light JS for Tabs/Drag/Eye Toggles
        window.baseUi = {
            init: function({ bus, store }) {
                // Tab Switching
                window.switchTab = function(tab) {
                    document.querySelectorAll('.base-tab').forEach(t => t.classList.remove('active'));
                    event.target.classList.add('active');
                    document.getElementById('dock-content').innerHTML = tab === 'layers' ? document.getElementById('layers-tab-content').innerHTML : 
                        tab === 'effects' ? document.getElementById('effects-tab').innerHTML : document.getElementById('masks-tab').innerHTML;
                };
                
                // Layer Drag Reorder (Static Anim)
                let draggedItem = null;
                const layers = document.querySelectorAll('.base-layer');
                layers.forEach(layer => {
                    layer.addEventListener('dragstart', e => {
                        draggedItem = layer;
                        e.dataTransfer.effectAllowed = 'move';
                        layer.classList.add('dragging');
                    });
                    layer.addEventListener('dragend', e => {
                        layer.classList.remove('dragging');
                        draggedItem = null;
                    });
                    layer.addEventListener('dragover', e => {
                        e.preventDefault();
                        e.dataTransfer.dropEffect = 'move';
                        if (layer !== draggedItem) {
                            const placeholder = document.createElement('div');
                            placeholder.classList.add('base-layer', 'placeholder');
                            layer.after(placeholder);
                            layer.before(draggedItem);
                            placeholder.remove();
                        }
                    });
                    layer.addEventListener('drop', e => e.preventDefault());
                });
                
                // Eye Toggle (Static)
                window.toggleEye = function(eye) {
                    eye.textContent = eye.textContent === '👁' ? '🙈' : '👁';
                };
                
                // Emit for bus
                bus.emit('baseUiLoaded');
                console.log('Base UI fully initialized - tabs, drag, toggles active');
            }
        };
        // Hidden tab contents (for switchTab)
        document.getElementById('dock-content').id = 'layers-tab-content';
    </script>
</body>
</html>